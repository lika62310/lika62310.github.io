---
title: "Sårbarheder i LazyCatz"
date: 2025-11-25
tags: [cybersecurity, projekt]
layout: default
---
**Scope**: Lokal app ved http//localhost:7000, endpoints /Auth/Login, /Customers/Create, /Customers/Edit, /Booking/Create; brugeroller user og admin

**Framework**: OWASP [Web Security Testing Guide (WSTG)](https://owasp.org/www-project-web-security-testing-guide/stable/)

**Fund**
| Fund                              | Risiko | Berørte endpoints |
|-----------------------------------|--------|-------------------|
| Utilstrækkelig password-politik   | mellem | /Auth/Login       |
| Manglende rate limiting ved login | mellem | /Auth/Login       |
| Mulighed for rolle eskalering     | høj    | /Customers/       |


#### Mapping
Fundne stier fra Burp sitemap:

<img width="640" height="240" alt="image" src="https://github.com/user-attachments/assets/4fbd028f-1407-4f3d-be56-6d57fc19071d" />

### Login

#### 1. Password politik

Ved oprettelse af bruger fundet manglende password politik, i det det er lykkedes at oprette en bruger med et kodeord bestående af ét tegn. Per NIST guidelines bør et kodeord:
1. bestå af 8-64 tegn (da længere kodeord er sværere at knække) - gerne i form af passphrases,
2. ikke være lette at gætte eller fundet i læk - en blocklist bør bruges for at udelukke almindelige og kompromiterede kodeord,
3. kunne skiftes ved tilsendte links og verificeringskoder - ikke ved sikkerhedsspørgsmål,
4. skiftes når kompromiteret - ikke fast/tvungent,
5. suppleres af MFA og password managers.


#### 2. Rate Limiting

Forsøg med Burp Intruder, hvor login-formularen er sendt 100+ gange uden fejl viser manglende rate limiting. Dette gør applikationen sårbar overfor brute force og dictionary attacks, i det en potentiel angriber ikke forhindres i at prøve flere gange. 

<img width="1002" height="211" alt="image" src="https://github.com/user-attachments/assets/961e6ed7-1ecf-4ffb-957b-8a9ea913a98a" />

### Brugerroller
Når en bruger oprettes, kan anmodningen interceptes (her vha. Burp) og ændres til at indeholde en brugerrolle. Her er IsAdmin sat til True, og ved efterfølgende login ses, at brugeren har admin-rettigheder - heriblandt adgang til analysedata og en kundeliste, hvor brugere kan ses, rettes og fjernes. På samme vis kan en eksisterende bruger opnå adminrettigheder ved at intercepte indsendelsen af 'rediger profil'-formularen ved /Customers/Edit. 

<img width="820" height="297" alt="image" src="https://github.com/user-attachments/assets/39df5f8c-0dd2-4664-9914-3dfe1ac6d473" />

<img width="1158" height="318" alt="image" src="https://github.com/user-attachments/assets/be9b3e70-c5d2-449b-aa76-5e5a491141d4" />

### Yderligere mulige sårbarheder undersøgt
- SQL injection ved login (som tidligere nævnt [her](https://lika62310.github.io/2025/10/29/juice-2.html), under 'Sammenligning med LazyCatz) - brug af prepared statements gør, at forespøgslen ikke påvirkes af udkommenteringer el.lign., og fejlbeskeden afslører ikke noget om databasen.
- Reflected XSS forsøgt ved ændring af bruger og oprettelse af booking, men forhindres ved escaping og formatering af input.
- IDOR - stien til ændring af bruger /Customers/Edit/{customerId} indeholder en reference til brugerId, men brugeren kan ikke tilgå eller ændre andre brugere ved hjælp af dette. 

