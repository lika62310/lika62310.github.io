---
title: "Juice Shop (2 stjerner)"
date: 2025-10-29
tags: [cybersecurity]
---

Et par vidrere fosøg med udfordringer fra [OWASP Juice Shop](https://lika62310.github.io/2025/10/24/juice.html).

#### SQL Injection og adgangskontrol

*Login Admin* udfordringen kan løses ved hjælp af SQL-injektion, hvor SQL-kode indsættes i et input felt. Hvis ' eller ' OR True indsættes, vises en object-fejl, hvilket tyder på manglende inputvalidering. Hvis al kode efter queryen udkommenteres ved -- (så der i feltet skrives ' OR True--), er det irrelevant hvad der indsættes i passwordfeltet (da det ikke læses), og der kan nu logges ind. 

Efter at være logget ind som admin, er det muligt at finde en admin-side under /Administration (udfordring *Admin Section*), hvorfra registrede brugere samt anmeldelser kan ses (og fjernes, 
*Five-Star Feedback*)

<img width="1487" height="371" alt="image" src="https://github.com/user-attachments/assets/a72f7703-77e8-4f47-afb5-e39c7debaad8" />

Selv uden injektion er dette let tilgængeligt - adgang til adminbrugeren kan let brute forces. Brugernavnet er, som kunne forventes, admin@juice-sh.op, mens kodeordet hurtigt kan gættes til admin123 - og endnu hurtigere ville kunne knækkes ved et dictionary attack. 
Her ville en forsvarlig password politik (se [NIST](https://pages.nist.gov/800-63-4/sp800-63b/passwords/)) samt en begrænsning af antal gæt. 

#### Sammenligning med LazyCatz (projekt) 

Prøves samme teknik med SQL-injektion, som lykkedes i Juice Shop, i vores projekt, fåes kun en 'invalid input'-fejl, da vi bruger stored procedures for at beskytte imod injections. 

<img width="427" height="232" alt="image" src="https://github.com/user-attachments/assets/6c69f832-6239-484b-893a-5c476912de65" />

#### Test login

Login-oplysninger kan findes frit tilgængeligt på siden - her ses resultatet af en inspektion af main.js, hvor der er søgt efter 'username':

<img width="816" height="355" alt="juicepw" src="https://github.com/user-attachments/assets/1ee7b39b-773c-4288-af2c-aacaa8b204ec" />

En afprøvning af oplysningerne viser, at de virker.

#### Kurvadgang og session keys

På kurv-siden, kan der under session storage ses værdien 'bid', som kunne ligne et id. Dette kan testesved at rette den til andet nummer gemidlæse kurven - hvor der nu kan ses indholdet af en andens kurv. Her udnyttes horizotal privilege escalation, hvor brugeren for adgang til indhold på samme adgangsniveau. 

#### Datasikkerhed og metadata

Ved at se på billederne på /photo-wall kan op til flere profiler tilgåes ved brug af 'glemt password'-funktionaliteten. Allerede ved indtastning af Emmas mail (emma@juice-sh.op) dukker hendes sikkerhedsspørgsmål op, som vedrører hendes første arbejdsplads. På Photo Wall ses et billede fra 'E=ma²' med beskrivelsen 'My old workplace...'. Ved en gennemgang af billedet kan et skilt findes, hvor der umiddelart står ITsec.

<img width="782" height="370" alt="image" src="https://github.com/user-attachments/assets/2939209c-8a31-4e4f-a58c-9ae8f6123e13" />

ITsec viser sig (efter flere forsøg ift. typografien..) at være det rigtige svar til Emmas sikkerhedsspørgsmål, og hendes kodeord kan nu ændres. 

Ligeledes efterspørger Johns sikkerhedsspørgsmål et vandrested, mens han har lagt et billede op af en sti med beskrivelsen 'I love going hiking here...'. Mens der ikke afsøres noget på billedet (med mindre man kender området!) er billedet metadata mere afslørende; undersøges dette findes koordinaterne for, hvor billedet er taget. Sættes denne ind i Google Maps, vises et område i Kentucky, hvor der både findes en skov og individuelle vandrestier. 

<img width="1008" height="93" alt="image" src="https://github.com/user-attachments/assets/04a46063-b37b-401c-885e-f3d6161eb0f7" />
<img width="1117" height="673" alt="image" src="https://github.com/user-attachments/assets/5eef63c6-d6f0-4acb-8639-5f59267b0516" />

Efter et par forsøg med mulige områder, viser svaret sig at være Daniel Boone National Forest, og Johns kodeord er ændret.

Sikkerhedsspørgsmål er desuden oplagte mål for social engineering, og [anbefales ikke pr. NIST guidelines](https://pages.nist.gov/800-63-3/sp800-63b.html#sec5). 




